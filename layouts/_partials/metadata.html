<div class="metadata">

{{- with .Params.gre_id }}
	{{ $url := print $.Site.BaseURL "id/" . "/" }}
	<div>
		Permalink: <a href="{{ $url }}">{{ $url }}</a>
	</div>
{{- end }}

{{- $page := .Page -}}

{{/* create dict of all people pages (name: permalink) */}}
{{ $people := dict }}
{{ range where .Site.Pages "Type" "people" }}
    {{ $people = merge $people (dict .Title .Permalink) }}
{{ end }}

{{- with .Params.author -}}
	{{- $vals := partial "listify.html" . -}}
	<div>
		Author{{ if gt (len $vals) 1 }}s{{ end }}:
		{{/* List each name separated by commas, and link the name if it has a people page */}}
    	{{ range $i, $v := $vals }}
			{{- if ne $i 0 -}}, {{ end -}}
			{{ $link := index $people $v }}
			{{ if $link }}
				<a href="{{ $link }}">{{ $v }}</a>
			{{ else }}
				{{ $v }}
			{{ end }}
		{{ end }}
	</div>
{{- end }}

{{- with .Params.editor }}
	{{ $vals := partial "listify.html" . }}
	<div>
		Editor{{ if gt (len $vals) 1 }}s{{ end }}:
		{{/* List each name separated by commas, and link the name if it has a people page */}}
    	{{ range $i, $v := $vals -}}
			{{- if ne $i 0 -}}, {{ end -}}
			{{ $link := index $people $v }}
			{{ if $link }}
				<a href="{{ $link }}">{{ $v }}</a>
			{{ else }}
				{{ $v }}
			{{ end }}
		{{ end }}
	</div>
{{- end }}

{{/*
{{- with .Date -}}
	<div>Updated: {{ time.Format "2006-01-02" . }}</div>
{{- end -}}
*/}}

</div>